/*!
 * hozzz
 * @author Teng Long
 * @version 0.0.0
 * @time 2014-05-22 21:3
 */

var H=H||{};H.User=Backbone.Model.extend({isAuth:function(){return!!this.get("id")},login:function(){},logout:function(){}});var H=H||{};H.Router=Backbone.Router.extend({routes:{"album/:id":"checkOutAlbum","user/:id":"checkOutUser"},checkOutAlbum:function(a){console.log(a)},checkOutUser:function(a){console.log(a)}}),Backbone.history.start({pushState:!0}),H.router=new H.Router;var H=H||{};H.View=Backbone.View.extend({className:"View",initialize:function(a){a&&(a.options&&(this.options=a.options),this.name=a.name?a.name:"",a.data&&(this.data=a.data)),this.$el.addClass(this.className),this._childViewIdMappings={},this.$el.removeAttr("id")},size:function(){return this.children.length},childAt:function(a){return this.children[a]},getChildViewById:function(a){return this._childViewIdMappings[a]},setChildViewById:function(a,b){this._childViewIdMappings[a]=b},findChildViewByElement:function(a){return _.filter(this.children,function(b){return b.$el.is(a)})},destory:function(){},detachAllEvents:function(){},appendChild:function(a){this.$el.append(a.html),H.viewFactory.append(siblingViewData.view,this),console.log("appended children")},removeChild:function(){},appendSibling:function(a){this.parent.$el.append(a.html),H.viewFactory.append(a.view,this.parent),console.log("appended a sibling!!")},replaceEle:function(a){this.$el.replaceWith(a),this.remove(),this.off()},replaceView:function(a){this.parent.children.push(H.viewFactory.create(a,this.parent.$el))},showLoading:function(){console.log("Loading...")}});var H=H||{};H.loadViewConstructor=function(a){return H.views[a]},H.viewFactory={create:function(a,b){b=b||null;var c=new(H.loadViewConstructor(a.name))({el:$("#"+a.uid,b),options:a.options,name:a.name,data:a.data});return a.children&&(c.children=_.map(a.children,function(a){var b=H.viewFactory.create(a,c.$el);return b.parent=c,c.setChildViewById(b.cid,b),b})),c},append:function(a,b){b.children.push(H.viewFactory.create(a,b.$el))}};var H=H||{};H.Resource=function(a,b){this.name=a,this.data=JSON.stringify(b)},_.extend(H.Resource.prototype,{call:function(a,b){var c=this._call(a);return c.fail(function(){}),b&&b.success&&c.done(b.success),b&&b.error&&c.fail(b.error),b&&b.complete&&c.always(b.complete),c},_call:function(a){var b=new $.Deferred,c="/resource/"+this.name+"/"+a+"/",d={from:window.location.pathname,data:this.data};return $.ajax({cache:!1,url:c,data:d,dataType:"json",type:a,complete:function(a,c){if("abort"===c)return void b.reject("aborted");if("error"===c){var d={html:'<ul class="default" id="defaultItems-1"> <li class="item" id="item-1"> <div class="avatar"> <img src="../src/img/a.png" alt=""> <span class="name">client</span> </div> <div class="content"> <div class="front"> <div> <a href="" class="calbum"><img src="../src/img/img1.png" alt=""></a> </div> <div> <span class="title">男士 手提包 时尚元素</span><br> <a class="like" id="button-1"  href="#"><span>1054</span></a> </div> </div> <div class="peek"> <div class="sub-item"><a href=""><img src="" alt=""></a></div> </div> </div> </li> <li class="item" id="item-2"> <div class="avatar"> <img src="../src/img/a.png" alt=""> <span class="name">client</span> </div> <div class="content"> <div class="front"> <div> <a href="" class="calbum"><img src="../src/img/img1.png" alt=""></a> </div> <div> <span class="title">男士 手提包 时尚元素</span><br> <a class="like" id="button-2"  href="#"><span>1054</span></a> </div> </div> <div class="peek"> <div class="sub-item"><a href=""><img src="" alt=""></a></div> </div> </div> </li> <li class="item" id="item-3"> <div class="avatar"> <img src="../src/img/a.png" alt=""> <span class="name">client</span> </div> <div class="content"> <div class="front"> <div> <a href="" class="calbum"><img src="../src/img/img1.png" alt=""></a> </div> <div> <span class="title">男士 手提包 时尚元素</span><br> <a class="like" id="button-3"  href="#"><span>1054</span></a> </div> </div> <div class="peek"> <div class="sub-item"><a href=""><img src="" alt=""></a></div> </div> </div> </li> </ul>',view:{uid:"defaultItems-1",name:"defaultItems",attrs:{className:"default"},data:{createdAt:"20140515092039"},children:[{uid:"item-1",name:"item",attrs:{className:"item"},children:[{uid:"button-1",name:"likeButton",likeId:"82942934294",attrs:{className:"like"}}],data:{itemId:"239879342089304582304",author:"Brian Long",time:"201405161129",like:"1548"}},{uid:"item-2",name:"item",attrs:{className:"item"},data:{itemId:"304582304",author:"B Long",time:"20105161129",like:"148"},children:[{uid:"button-2",name:"likeButton",likeId:"908203842042",attrs:{className:"like"}}]},{uid:"item-3",name:"item",attrs:{className:"item"},children:[{uid:"button-3",name:"likeButton",likeId:"294829304242",attrs:{className:"like"}}],data:{itemId:"2398",author:"Brian asdfasLong",time:"201405161129",like:"154"}}]}};return void b.reject(d)}var e=JSON.parse(a.responseText);b.resolve(e)}}),b.promise()},get:function(a){return this.call("get",a)},post:function(a){return this.call("post",a)}}),H.resourceFactory=function(a,b){return new H.Resource(a,b)};var H=H||{};H.views={},H.views.app=H.View.extend(),H.views.item=H.View.extend({events:{"click .like":"sendLikeButton","click .avatar":"checkOutAuthor"},sendLikeButton:function(a){return console.log(a.currentTarget===this),console.log($(a.currentTarget).html()),console.log(this.data.like+" "+this.data.itemId),!1},checkOutAuthor:function(a){var b=this.data;return H.router.navigate("user/"+b.authorId,{trigger:!0}),this.showLoading(),a.preventDefault(),!1}}),H.views.likeButton=H.View.extend(),H.views.Items=H.View.extend({checkOutPic:function(a){var b=this;console.log($(a.currentTarget).html()),this.showLoading();var c=H.resourceFactory("HozzzAlbum",{fuck:"you"});return c=c.get({success:function(a){b.appendSibling(a),console.log(b)},error:function(a){b.replaceEle(a.html),b.replaceView(a.view)}}),a.preventDefault(),!1}}),H.views.squareItems=H.views.Items.extend({events:{"click .content":"checkOutPic"}}),H.views.defaultItems=H.views.Items.extend({events:{"click .front":"checkOutPic","mouseenter .front":"dropDownAlbum"},dropDownAlbum:function(a){var b=$(a.currentTarget).closest(".item"),c=this.findChildViewByElement(b)[0];console.log("drop down"),console.log(c.data.author)}});var H=H||{};H.views.Button=H.View.extend({events:{click:"onClick"}}),H.views.addHoz=H.views.Button.extend({onClick:function(){console.log("add")}}),H.views.backToTop=H.views.Button.extend({onClick:function(){return console.log("back to top"),!1}});var H=H||{};H.views.layoutButton=H.View.extend(),H.views.rightBar=H.View.extend(),H.views.viewLayout=H.View.extend({events:{"click li":"changeViewLayout"},changeViewLayout:function(a){var b=this.findChildViewByElement($(a.currentTarget))[0];return console.log("change to view: "+b.data.view),!1}});var H=H||{};H.init=function(a){H.app=H.viewFactory.create(a.modules)};
//# sourceMappingURL=bundle.min.map