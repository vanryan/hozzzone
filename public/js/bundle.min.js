/*!
 * hozzz
 * @author Teng Long
 * @version 0.0.0
 * @time 2014-05-16 14:28
 */

var H=H||{};H.User=Backbone.Model.extend({isAuth:function(){return!!this.get("id")},login:function(){},logout:function(){}});var H=H||{};H.Router=Backbone.Router.extend({routes:{"album/:id":"checkOutAlbum","user/:id":"checkOutUser"},checkOutAlbum:function(a){console.log(a)},checkOutUser:function(a){console.log(a)}}),Backbone.history.start({pushState:!0}),H.router=new H.Router;var H=H||{};H.View=Backbone.View.extend({className:"View",initialize:function(a){a&&(a.options&&(this.options=a.options),this.name=a.name?a.name:"",a.data&&(this.data=a.data)),this.$el.addClass(this.className),this._childViewIdMappings={},this.$el.removeAttr("id")},size:function(){return this.children.length},childAt:function(a){return this.children[a]},getChildViewById:function(a){return this._childViewIdMappings[a]},setChildViewById:function(a,b){this._childViewIdMappings[a]=b},findChildViewByElement:function(a){return _.filter(this.children,function(b){return b.$el.is(a)})},destory:function(){},remove:function(){},detachAllEvents:function(){},appendChild:function(a){this.$el.append(a.html),H.viewFactory.append(siblingViewData.view,this),console.log("appended children")},removeChild:function(){},appendSibling:function(a){this.parent.$el.append(a.html),H.viewFactory.append(a.view,this.parent),console.log("appended a sibling!!")},showLoading:function(){console.log("Loading...")}});var H=H||{};H.loadViewConstructor=function(a){return H.views[a]},H.viewFactory={create:function(a,b){b=b||null;var c=new(H.loadViewConstructor(a.name))({el:$("#"+a.uid,b),options:a.options,name:a.name,data:a.data});return a.children&&(c.children=_.map(a.children,function(a){var b=H.viewFactory.create(a,c.$el);return b.parent=c,c.setChildViewById(b.cid,b),b})),c},append:function(a,b){b.children.push(H.viewFactory.create(a,b.$el))}};var H=H||{};H.Resource=function(a,b){this.name=a,this.data=JSON.stringify(b)},_.extend(H.Resource.prototype,{call:function(a,b){var c=this._call(a);return c.fail(function(a){console.log(a)}),b&&b.success&&c.done(b.success),b&&b.error&&c.fail(b.error),b&&b.complete&&c.always(b.complete),c},_call:function(a){var b=new $.Deferred,c="/resource/"+this.name+"/"+a+"/",d={from:window.location.pathname,data:this.data};return $.ajax({cache:!1,url:c,data:d,dataType:"json",type:a,complete:function(a,c){if("abort"===c)return void b.reject("aborted");if("error"===c)return void b.reject("error, fuck!");var d=JSON.parse(a.responseText);b.resolve(d)}}),b.promise()},get:function(a){return this.call("get",a)},post:function(a){return this.call("post",a)}}),H.resourceFactory=function(a,b){return new H.Resource(a,b)};var H=H||{};H.views={},H.views.app=H.View.extend(),H.views.item=H.View.extend({events:{"click .like":"sendLikeButton","click .avatar":"checkOutAuthor"},sendLikeButton:function(a){return console.log(a.currentTarget===this),console.log($(a.currentTarget).html()),console.log(this.data.like+" "+this.data.itemId),!1},checkOutAuthor:function(a){var b=this.data;return H.router.navigate("user/"+b.authorId,{trigger:!0}),this.showLoading(),a.preventDefault(),!1}}),H.views.likeButton=H.View.extend(),H.views.Items=H.View.extend({checkOutPic:function(a){var b=this;console.log($(a.currentTarget).html()),this.showLoading();var c=H.resourceFactory("HozzzAlbum",{fuck:"you"});return c=c.get({success:function(a){b.appendSibling(a),console.log(b)},error:function(){console.log("notify errors")}}),console.log(c),a.preventDefault(),!1}}),H.views.squareItems=H.views.Items.extend({events:{"click .img-overlay":"checkOutPic"}}),H.views.defaultItems=H.views.Items.extend({events:{"click .front":"checkOutPic","mouseenter .front":"dropDownAlbum"},dropDownAlbum:function(a){var b=$(a.currentTarget).closest(".item"),c=this.findChildViewByElement(b)[0];console.log("drop down"),console.log(c.data.author)}});var H=H||{};H.views.Button=H.View.extend({events:{click:"onClick"}}),H.views.addHoz=H.views.Button.extend({onClick:function(){console.log("add")}}),H.views.backToTop=H.views.Button.extend({onClick:function(){return console.log("back to top"),!1}});var H=H||{};H.views.layoutButton=H.View.extend(),H.views.rightBar=H.View.extend(),H.views.viewLayout=H.View.extend({events:{"click li":"changeViewLayout"},changeViewLayout:function(a){var b=this.findChildViewByElement($(a.currentTarget))[0];return console.log("change to view: "+b.data.view),!1}});var H=H||{};H.init=function(a){H.app=H.viewFactory.create(a.modules)};
//# sourceMappingURL=bundle.min.map